<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="title">SAP CPI Package Decoder</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/bpmn-js@17.0.2/dist/assets/bpmn-js.css"
    />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1 data-i18n="title">üîì SAP CPI Package Decoder</h1>
        <select id="langSelect" class="lang-select">
          <option value="pt-BR">Portugu√™s</option>
          <option value="en-US" selected>English</option>
          <option value="es-ES">Espa√±ol</option>
        </select>
        <p data-i18n="subtitle">
          Decodifique e visualize o conte√∫do de pacotes exportados do SAP Cloud
          Integration
        </p>
      </div>

      <div class="content">
        <div class="info-box">
          <strong data-i18n="how_to_use">Como usar:</strong>
          <ol>
            <li>
              <span data-i18n="step_upload">Fa√ßa o upload do arquivo <code>.zip</code> exportado do SAP CPI.</span>
            </li>
            <li>
              <span data-i18n="step_auto">Os arquivos contidos no pacote ser√£o automaticamente
              decodificados.</span>
            </li>
          </ol>
        </div>

        <div class="upload-area" id="uploadArea">
          <div>
            <h3 data-i18n="drag_drop">üìÅ Arraste o arquivo .zip aqui ou clique para selecionar</h3>
            <button
              class="upload-btn"
              onclick="document.getElementById('fileInput').click()"
            >
              <span data-i18n="select_zip">Selecionar Arquivo ZIP</span>
            </button>
            <input
              type="file"
              id="fileInput"
              accept=".zip"
              multiple
            />
            <p style="margin-top: 15px; color: #666" data-i18n="supports_zip">
              Suporta: Pacotes .zip do SAP CPI
            </p>
          </div>
        </div>

        <!-- √Årea de a√ß√µes gerais (fora dos pacotes) -->
        <div id="downloadSection" class="result-section" style="text-align: center;">
          <!-- Download global antigo fica escondido; usamos download por pacote -->
          <!-- <button id="downloadBtn" class="download-btn" style="display:none" data-i18n="download_decoded">‚¨áÔ∏è Baixar Recursos Decodificados</button> -->
          <!-- Refresh global permanece vis√≠vel -->
          <button id="refreshBtn" class="download-btn" data-i18n="refresh" title="Limpar resultados e come√ßar de novo">üîÑ Refresh</button>
          <!-- Novo bot√£o de Relat√≥rio Geral -->
          <button id="btnGlobalReport" class="download-btn" title="Exporta um relat√≥rio com endpoints de todos os pacotes">üìä Relat√≥rio Geral (Excel)</button>
        </div>

        <div id="results" class="results"></div>

        <div class="project-info">
          <p data-i18n="project_info">
            Este projeto est√° dispon√≠vel no
            <a href="https://github.com/lrcherubini/cpi-package-decoder" target="_blank" rel="noopener noreferrer">GitHub</a>.
            Colabora√ß√µes s√£o bem-vindas!
          </p>
        </div>
      </div>
    </div>

    <div id="editorModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modalTitle" data-i18n="modal_title">Conte√∫do do Arquivo</h3>
          <div class="modal-controls">
            <select id="languageSelect" class="language-select">
              <option value="javascript">JavaScript</option>
              <option value="groovy">Groovy</option>
              <option value="xml">XML</option>
              <option value="json">JSON</option>
              <option value="sql">SQL</option>
              <option value="java">Java</option>
              <option value="python">Python</option>
              <option value="plaintext">Plain Text</option>
            </select>
            <select id="fileSelect" class="file-select"></select>
            <button id="formatBtn" class="control-btn" title="Formatar c√≥digo">‚ú®</button>
            <button id="copyBtn" class="control-btn" title="Copiar conte√∫do">üìã</button>
            <button id="viewSwitchBtn" class="control-btn" style="display:none;" title="Switch View">üîÄ</button>
            <button id="fullscreenBtn" class="control-btn" title="Tela cheia">‚õ∂</button>
            <button id="closeModal" class="close-btn">&times;</button>
          </div>
        </div>
        <div id="monacoEditor" class="monaco-container"></div>
        <div id="renderedView" class="rendered-container" style="display:none;"></div>
      </div>
    </div>

    <script src="lib/jszip.min.js"></script>
    <script src="https://unpkg.com/bpmn-js@17.0.2/dist/bpmn-navigated-viewer.development.js"></script>
    <script src="js/i18n.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    <script src="js/globals.js"></script>
    <script src="js/editor.js"></script>
    <script src="js/fileLoader.js"></script>
    <!-- XLSX precisa estar carregado ANTES do relat√≥rio geral -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Script do Relat√≥rio Geral -->
    <script src="js/global_report_all_packages.js"></script>
    <!-- Seu script de handlers da UI (deixe por √∫ltimo) -->
    <script src="js/uiHandlers.js"></script>
  </body>
</html>
